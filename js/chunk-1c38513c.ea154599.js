(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c38513c"],{"2af1":function(t,e,n){"use strict";var a=n("23e7"),s=n("f748");a({target:"Math",stat:!0},{sign:s})},"330c":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"container"},[e("div",{staticClass:"toolbar"},[e("div",{staticClass:"Vtoolbar_wrap"},[e("div",{staticClass:"switch-wrap"},[e("el-switch",{staticStyle:{zoom:"1.1"},attrs:{"active-text":t.$t("hd"),"inactive-text":t.$t("low")},on:{change:t.qualityChange},model:{value:t.IsQuality,callback:function(e){t.IsQuality=e},expression:"IsQuality"}})],1),e("div",{staticClass:"blue_button button_base",attrs:{id:"App-DownloadLink"},on:{click:t.downloadClick}},[t._m(0),e("span",[t._v(" Â "+t._s(t.$t("download"))+" ")])])])]),e("button",{staticClass:"cancel_button blue_button button_base",attrs:{title:"Exit",id:"App-Toolbar-Exit"},on:{click:t.closeToBack}},[e("img",{attrs:{src:n("541d"),importance:"low",decode:"async",loading:"lazy"}})])]),e("previewComponents",{attrs:{originUrl:t.originUrl,resultUrl:t.resultUrl,boxSize:t.boxSize}}),t.successProcess?t._e():e("div",{staticClass:"progress-wrap"},[e("img",{attrs:{src:n("12ae"),alt:"loading"}})])],1)},s=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon_left",staticStyle:{position:"relative"}},[e("img",{attrs:{src:n("c482"),importance:"low",decode:"async",loading:"lazy",id:"Viewer-DownloadCurrentIcon"}})])}],o=(n("14d9"),n("c7eb")),r=n("1da1"),c=function(){var t=this,e=t._self._c;return e("div",{staticClass:"canvas-container"},[e("canvas",{ref:"canvas1",staticClass:"canvas canvas1"}),e("canvas",{ref:"canvas2",staticClass:"canvas canvas2"})])},h=[],u=(n("a9e3"),n("2af1"),n("5530")),l=n("2f62"),f={props:{originUrl:String,resultUrl:String,boxSize:Number},data:function(){return{canvas1:null,canvas2:null,ctx1:null,ctx2:null,img1:new Image,img2:new Image,isDragging:!1,offsetX1:0,offsetY1:0,offsetX2:0,offsetY2:0,scale1:.8,scale2:.8,startX:0,startY:0,canvasScale:1}},computed:Object(u["a"])({},Object(l["c"])(["uploadImageName"])),methods:{drawCanvas1:function(){this.ctx1.clearRect(0,0,this.canvas1.width,this.canvas1.height),this.ctx1.drawImage(this.img1,this.offsetX1,this.offsetY1,this.img1.width*this.scale1,this.img1.height*this.scale1),this.ctx1.font="bold ".concat(this.boxSize/1e3*20,"px Arial"),this.ctx1.fillStyle="rgba(0, 0, 0, 1)";var t="Original Image",e=this.boxSize/2-100,n=this.boxSize/10,a=this.boxSize/10*9;this.ctx1.fillText(t,e,n),this.ctx1.fillText(this.uploadImageName,e-100,a),requestAnimationFrame(this.drawCanvas1)},drawCanvas2:function(){this.ctx2.clearRect(0,0,this.canvas2.width,this.canvas2.height),this.ctx2.drawImage(this.img2,this.offsetX2,this.offsetY2,this.img2.width*this.scale2,this.img2.height*this.scale2),this.ctx2.font="bold ".concat(this.boxSize/1e3*20,"px Arial"),this.ctx2.fillStyle="rgba(0, 0, 0, 1)";var t="EffectImg Result",e=this.boxSize/2-100,n=this.boxSize/10,a=this.boxSize/10*9;this.ctx2.fillText(t,e,n),this.ctx2.fillText(this.uploadImageName,e-100,a),requestAnimationFrame(this.drawCanvas2)},handleMouseDown:function(t,e){this.isDragging=!0,this.startX=t.clientX*this.canvasScale-(e===this.canvas1?this.offsetX1:this.offsetX2),this.startY=t.clientY*this.canvasScale-(e===this.canvas1?this.offsetY1:this.offsetY2)},handleMouseUp:function(){this.isDragging=!1},handleMouseMove:function(t,e){if(this.isDragging){var n=t.clientX*this.canvasScale-this.startX,a=t.clientY*this.canvasScale-this.startY;e===this.canvas1?(this.offsetX1=n,this.offsetY1=a):(this.offsetX2=n,this.offsetY2=a)}},handleMouseWheel:function(t,e){var n,a,s,i,o=Math.sign(t.deltaY),r=t.clientX*this.canvasScale-e.offsetLeft*this.canvasScale,c=t.clientY*this.canvasScale-e.offsetTop*this.canvasScale,h=.2;e===this.canvas1?(n=this.scale1,a=Math.max(.1,Math.min(10,this.scale1-o*this.scale1*h)),s=this.offsetX1,i=this.offsetY1):(n=this.scale2,a=Math.max(.1,Math.min(10,this.scale2-o*this.scale2*h)),s=this.offsetX2,i=this.offsetY2),s=a/n*(s-r)+r,i=a/n*(i-c)+c,e===this.canvas1?(this.scale1=a,this.offsetX1=s,this.offsetY1=i,this.scale2=this.scale1,this.offsetX2=this.offsetX1,this.offsetY2=this.offsetY1):(this.scale2=a,this.offsetX2=s,this.offsetY2=i,this.scale1=this.scale2,this.offsetX1=this.offsetX2,this.offsetY1=this.offsetY2),t.preventDefault()},handleResize:function(){this.canvas1.width=this.canvas1.offsetWidth*this.canvasScale,this.canvas1.height=this.canvas1.offsetHeight*this.canvasScale,this.canvas2.width=this.canvas2.offsetWidth*this.canvasScale,this.canvas2.height=this.canvas2.offsetHeight*this.canvasScale}},watch:{resultUrl:{handler:function(t){var e=this;this.img1.src=this.originUrl,this.img2.src=t,this.img1.onload=function(){var t=e.img1,n=t.width,a=t.height,s=e.canvas1.offsetHeight;e.canvasScale=a/s,e.offsetX1=(e.canvas1.offsetWidth*e.canvasScale-n)/2+e.boxSize/10,e.offsetX2=(e.canvas1.offsetWidth*e.canvasScale-n)/2+e.boxSize/10,e.offsetY1=(e.canvas1.offsetHeight*e.canvasScale-a)/2+e.boxSize/10,e.offsetY2=(e.canvas1.offsetHeight*e.canvasScale-a)/2+e.boxSize/10,e.handleResize(),e.drawCanvas1()},this.img2.onload=function(){e.drawCanvas2()}}}},mounted:function(){var t=this;this.canvas1=this.$refs.canvas1,this.canvas2=this.$refs.canvas2,this.ctx1=this.canvas1.getContext("2d"),this.ctx2=this.canvas2.getContext("2d"),this.canvas1.addEventListener("mousedown",(function(e){return t.handleMouseDown(e,t.canvas1)})),this.canvas2.addEventListener("mousedown",(function(e){return t.handleMouseDown(e,t.canvas2)})),window.addEventListener("mouseup",this.handleMouseUp),window.addEventListener("mousemove",(function(e){return t.handleMouseMove(e,t.canvas1)})),window.addEventListener("mousemove",(function(e){return t.handleMouseMove(e,t.canvas2)})),this.canvas1.addEventListener("wheel",(function(e){return t.handleMouseWheel(e,t.canvas1)})),this.canvas2.addEventListener("wheel",(function(e){return t.handleMouseWheel(e,t.canvas2)})),window.addEventListener("resize",this.handleResize)}},v=f,d=(n("debf"),n("2877")),g=Object(d["a"])(v,c,h,!1,null,"6ce0e6b8",null),p=g.exports,m=n("59a2");if(!b)var b={map:function(t,e){var n={};return e?t.map((function(t,a){return n.index=a,e.call(n,t)})):t.slice()},naturalOrder:function(t,e){return t<e?-1:t>e?1:0},sum:function(t,e){var n={};return t.reduce(e?function(t,a,s){return n.index=s,t+e.call(n,a)}:function(t,e){return t+e},0)},max:function(t,e){return Math.max.apply(null,e?b.map(t,e):t)}};var w=function(){var t=5,e=8-t,n=1e3;function a(e,n,a){return(e<<2*t)+(n<<t)+a}function s(t){var e=[],n=!1;function a(){e.sort(t),n=!0}return{push:function(t){e.push(t),n=!1},peek:function(t){return n||a(),void 0===t&&(t=e.length-1),e[t]},pop:function(){return n||a(),e.pop()},size:function(){return e.length},map:function(t){return e.map(t)},debug:function(){return n||a(),e}}}function i(t,e,n,a,s,i,o){var r=this;r.r1=t,r.r2=e,r.g1=n,r.g2=a,r.b1=s,r.b2=i,r.histo=o}function o(){this.vboxes=new s((function(t,e){return b.naturalOrder(t.vbox.count()*t.vbox.volume(),e.vbox.count()*e.vbox.volume())}))}function r(t,e){if(e.count()){var n=e.r2-e.r1+1,s=e.g2-e.g1+1,i=b.max([n,s,e.b2-e.b1+1]);if(1==e.count())return[e.copy()];var o,r,c,h,u=0,l=[],f=[];if(i==n)for(o=e.r1;o<=e.r2;o++){for(h=0,r=e.g1;r<=e.g2;r++)for(c=e.b1;c<=e.b2;c++)h+=t[a(o,r,c)]||0;l[o]=u+=h}else if(i==s)for(o=e.g1;o<=e.g2;o++){for(h=0,r=e.r1;r<=e.r2;r++)for(c=e.b1;c<=e.b2;c++)h+=t[a(r,o,c)]||0;l[o]=u+=h}else for(o=e.b1;o<=e.b2;o++){for(h=0,r=e.r1;r<=e.r2;r++)for(c=e.g1;c<=e.g2;c++)h+=t[a(r,c,o)]||0;l[o]=u+=h}return l.forEach((function(t,e){f[e]=u-t})),function(t){var n,a,s,i,r,c=t+"1",h=t+"2",v=0;for(o=e[c];o<=e[h];o++)if(l[o]>u/2){for(s=e.copy(),i=e.copy(),r=(n=o-e[c])<=(a=e[h]-o)?Math.min(e[h]-1,~~(o+a/2)):Math.max(e[c],~~(o-1-n/2));!l[r];)r++;for(v=f[r];!v&&l[r-1];)v=f[--r];return s[h]=r,i[c]=s[h]+1,[s,i]}}(i==n?"r":i==s?"g":"b")}}return i.prototype={volume:function(t){var e=this;return e._volume&&!t||(e._volume=(e.r2-e.r1+1)*(e.g2-e.g1+1)*(e.b2-e.b1+1)),e._volume},count:function(t){var e=this,n=e.histo;if(!e._count_set||t){var s,i,o,r=0;for(s=e.r1;s<=e.r2;s++)for(i=e.g1;i<=e.g2;i++)for(o=e.b1;o<=e.b2;o++)r+=n[a(s,i,o)]||0;e._count=r,e._count_set=!0}return e._count},copy:function(){var t=this;return new i(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(e){var n=this,s=n.histo;if(!n._avg||e){var i,o,r,c,h=0,u=1<<8-t,l=0,f=0,v=0;for(o=n.r1;o<=n.r2;o++)for(r=n.g1;r<=n.g2;r++)for(c=n.b1;c<=n.b2;c++)h+=i=s[a(o,r,c)]||0,l+=i*(o+.5)*u,f+=i*(r+.5)*u,v+=i*(c+.5)*u;n._avg=h?[~~(l/h),~~(f/h),~~(v/h)]:[~~(u*(n.r1+n.r2+1)/2),~~(u*(n.g1+n.g2+1)/2),~~(u*(n.b1+n.b2+1)/2)]}return n._avg},contains:function(t){var n=this,a=t[0]>>e;return gval=t[1]>>e,bval=t[2]>>e,a>=n.r1&&a<=n.r2&&gval>=n.g1&&gval<=n.g2&&bval>=n.b1&&bval<=n.b2}},o.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map((function(t){return t.color}))},size:function(){return this.vboxes.size()},map:function(t){for(var e=this.vboxes,n=0;n<e.size();n++)if(e.peek(n).vbox.contains(t))return e.peek(n).color;return this.nearest(t)},nearest:function(t){for(var e,n,a,s=this.vboxes,i=0;i<s.size();i++)((n=Math.sqrt(Math.pow(t[0]-s.peek(i).color[0],2)+Math.pow(t[1]-s.peek(i).color[1],2)+Math.pow(t[2]-s.peek(i).color[2],2)))<e||void 0===e)&&(e=n,a=s.peek(i).color);return a},forcebw:function(){var t=this.vboxes;t.sort((function(t,e){return b.naturalOrder(b.sum(t.color),b.sum(e.color))}));var e=t[0].color;e[0]<5&&e[1]<5&&e[2]<5&&(t[0].color=[0,0,0]);var n=t.length-1,a=t[n].color;a[0]>251&&a[1]>251&&a[2]>251&&(t[n].color=[255,255,255])}},{quantize:function(c,h){if(!c.length||h<2||h>256)return!1;var u=function(n){var s,i=new Array(1<<3*t);return n.forEach((function(t){s=a(t[0]>>e,t[1]>>e,t[2]>>e),i[s]=(i[s]||0)+1})),i}(c);u.forEach((function(){}));var l=function(t,n){var a,s,o,r=1e6,c=0,h=1e6,u=0,l=1e6,f=0;return t.forEach((function(t){(a=t[0]>>e)<r?r=a:a>c&&(c=a),(s=t[1]>>e)<h?h=s:s>u&&(u=s),(o=t[2]>>e)<l?l=o:o>f&&(f=o)})),new i(r,c,h,u,l,f,n)}(c,u),f=new s((function(t,e){return b.naturalOrder(t.count(),e.count())}));function v(t,e){for(var a,s=t.size(),i=0;i<n;){if(s>=e)return;if(i++>n)return;if((a=t.pop()).count()){var o=r(u,a),c=o[0],h=o[1];if(!c)return;t.push(c),h&&(t.push(h),s++)}else t.push(a),i++}}f.push(l),v(f,.75*h);for(var d=new s((function(t,e){return b.naturalOrder(t.count()*t.volume(),e.count()*e.volume())}));f.size();)d.push(f.pop());v(d,h);for(var g=new o;d.size();)g.push(d.pop());return g}}}().quantize,x=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=t.naturalWidth,this.height=this.canvas.height=t.naturalHeight,this.context.drawImage(t,0,0,this.width,this.height)};x.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var C=function(){};C.prototype.getColor=function(t,e){return void 0===e&&(e=10),this.getPalette(t,5,e)[0]},C.prototype.getPalette=function(t,e,n){var a=function(t){var e=t.colorCount,n=t.quality;if(void 0!==e&&Number.isInteger(e)){if(1===e)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");e=Math.max(e,2),e=Math.min(e,20)}else e=10;return(void 0===n||!Number.isInteger(n)||n<1)&&(n=10),{colorCount:e,quality:n}}({colorCount:e,quality:n}),s=new x(t),i=function(t,e,n){for(var a,s,i,o,r,c=t,h=[],u=0;u<e;u+=n)s=c[0+(a=4*u)],i=c[a+1],o=c[a+2],(void 0===(r=c[a+3])||r>=125)&&(s>250&&i>250&&o>250||h.push([s,i,o]));return h}(s.getImageData().data,s.width*s.height,a.quality),o=w(i,a.colorCount);return o?o.palette():null},C.prototype.getColorFromUrl=function(t,e,n){var a=this,s=document.createElement("img");s.addEventListener("load",(function(){var i=a.getPalette(s,5,n);e(i[0],t)})),s.src=t},C.prototype.getImageData=function(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){if(200==this.status){var t=new Uint8Array(this.response);i=t.length;for(var n=new Array(i),a=0;a<t.length;a++)n[a]=String.fromCharCode(t[a]);var s=n.join(""),o=window.btoa(s);e("data:image/png;base64,"+o)}},n.send()},C.prototype.getColorAsync=function(t,e,n){var a=this;this.getImageData(t,(function(t){var s=document.createElement("img");s.addEventListener("load",(function(){var t=a.getPalette(s,5,n);e(t[0],this)})),s.src=t}))};var S={name:"cover",components:{previewComponents:p},mixins:[m["a"]],data:function(){return{IsQuality:!1}},computed:{},methods:{effectClick:function(t){this.activeEffectIndex=t,this.getPngColorImage()},qualityChange:function(){this.getPngColorImage()},closeToBack:function(){this.$router.push("/")},downloadClick:function(){this.$router.push("/download")}},watch:{},mounted:function(){var t=this;return Object(r["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.colorThief=new C,t.uploadImageUrl?window.wnd.loaded?t.getImageListByColor():t.searchInterVal=setInterval((function(){window.wnd.loaded&&(clearInterval(t.searchInterVal),t.getImageListByColor())}),100):t.$router.push("/");case 2:case"end":return e.stop()}}),e)})))()}},y=S,z=(n("559f"),Object(d["a"])(y,a,s,!1,null,"64cbcfda",null));e["default"]=z.exports},"3aeb":function(t,e,n){},"541d":function(t,e,n){t.exports=n.p+"img/cancel.e8e7b8eb.svg"},"559f":function(t,e,n){"use strict";n("94d5")},"94d5":function(t,e,n){},debf:function(t,e,n){"use strict";n("3aeb")}}]);